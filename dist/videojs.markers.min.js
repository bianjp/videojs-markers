"use strict";!function(e,r,i){function t(){var e=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==r?i:3&i|8).toString(16)});return r}function a(r){function i(){x.sort(function(e,r){return f.markerTip.time(e)-f.markerTip.time(r)})}function a(r){e.each(r,function(e,r){r.key=t();var i=s(r);if(y.find(".vjs-progress-control").append(i),f.markerTip.display){var a=i.find(".vjs-tip");a.css("left",-a.outerWidth()/2+i.width()/2-2+"px")}p[r.key]=r,x.push(r)}),i()}function o(e){return f.markerTip.time(e)/T.duration()*100}function s(r,i){var t=e('<div class="vjs-marker"><div class="marker"></div></div>');if(f.markerTip.display){var a='<div class="vjs-tip"><div class="vjs-tip-arrow"></div><div class="vjs-tip-inner">';r.image&&(a+='<img src="'+r.image+'">'),r.text&&(a+=r.text),a+="</div></div>",t.append(a)}return t.find(".marker").css(f.markerStyle),t.css({"margin-left":-t.width()/2+"px",left:o(r)+"%"}).attr("data-marker-key",r.key).attr("data-marker-time",f.markerTip.time(r)),r["class"]&&t.addClass(r["class"]),t.on("click",function(i){var t=!1;if("function"==typeof f.onMarkerClick&&(t=0==f.onMarkerClick(r)),!t){var a=e(this).data("marker-key");T.currentTime(f.markerTip.time(p[a]))}}),t}function l(){for(var e=0;e<x.length;e++){var r=x[e],t=y.find('.vjs-marker[data-marker-key="'+r.key+'"]'),a=f.markerTip.time(r);t.data("marker-time")!=a&&t.css({left:o(r)+"%"}).attr("data-marker-time",a)}i()}function m(e){b&&(j=-1,b.css("visibility","hidden")),h=-1;for(var r=0;r<e.length;r++){var t=e[r],a=x[t];a&&(delete p[a.key],x[t]=null,y.find('.vjs-marker[data-marker-key="'+a.key+'"]').remove())}for(var r=x.length-1;r>=0;r--)null===x[r]&&x.splice(r,1);i()}function c(){if(f.breakOverlay.display&&!(0>h)){var e=T.currentTime(),r=x[h],i=f.markerTip.time(r);e>=i&&e<=i+f.breakOverlay.displayTime?(j!=h&&(j=h,b.find(".vjs-break-overlay-text").text(f.breakOverlay.text(r))),b.css("visibility","visible")):(j=-1,b.css("visibility","hidden"))}}function d(){b=e('<div class="vjs-break-overlay"><div class="vjs-break-overlay-text"></div></div>').css(f.breakOverlay.style),y.append(b),j=-1}function k(){v(),c()}function v(){var e=function(e){return e<x.length-1?f.markerTip.time(x[e+1]):T.duration()},i=T.currentTime(),t=-1;if(-1!=h){var a=e(h);if(i>=f.markerTip.time(x[h])&&a>i)return;if(h===x.length-1&&i===T.duration())return}if(x.length>0&&i<f.markerTip.time(x[0]))t=-1;else for(var n=0;n<x.length;n++)if(a=e(n),i>=f.markerTip.time(x[n])&&a>i){t=n;break}t!=h&&(-1!=t&&r.onMarkerReached&&r.onMarkerReached(x[t]),h=t)}function u(){T.markers.removeAll(),a(r.markers),f.breakOverlay.display&&d(),k(),T.on("timeupdate",k)}var f=e.extend(!0,{},n,r),p={},x=[],y=e(this.el()),h=-1,T=this,g=null,b=null,j=-1;T.on("loadedmetadata",function(){u()}),T.markers={getMarkers:function(){return x},next:function(){for(var e=T.currentTime(),r=0;r<x.length;r++){var i=f.markerTip.time(x[r]);if(i>e){T.currentTime(i);break}}},prev:function(){for(var e=T.currentTime(),r=x.length-1;r>=0;r--){var i=f.markerTip.time(x[r]);if(e>i+.5){T.currentTime(i);break}}},add:function(e){a(e)},remove:function(e){m(e)},removeAll:function(){for(var e=[],r=0;r<x.length;r++)e.push(r);m(e)},updateTime:function(){l()},reset:function(e){T.markers.removeAll(),a(e)},destroy:function(){T.markers.removeAll(),b.remove(),g.remove(),T.off("timeupdate",c),delete T.markers}}}var n={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,time:function(e){return e.time}},breakOverlay:{display:!1,displayTime:3,text:function(e){return"Break overlay: "+e.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0, 0, 0, 0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(e){},onMarkerReached:function(e){},markers:[]};r.plugin("markers",a)}(jQuery,window.videojs);